MEPH.define("MEPH.graph.renderer.ConnectionRenderer",{requires:["MEPH.util.Renderer"],extend:"MEPH.graph.renderer.CanvasRenderer",properties:{singleNodePosition:null},initialize:function(){var a=this;MEPH.Events(a);a.singleNodePosition={x:100,y:100};a.callParent.apply(a,arguments)},draw:function(d,c,f){var e=this,b;f=f||{};var a=c.select(function(g){b=e.options(d);b=e.options(f);b.start=g.start;b.end=g.end;return b});return e.renderer.draw(a)},calculateEndPoints:function(d,h,c){var f=this;h=h||{x:0,y:0};var b=c.getZones();var a=b.summation(function(i,k,j){var l=i.getPosition();if(k){return{x:l.x+k.x,y:l.y+k.y}}return{x:l.x,y:l.y}})||{x:0,y:0};var e={x:(a.x/b.length),y:(a.y/b.length)};var g=c.getZones().select(function(i){var j=i.getPosition();return{start:{x:j.x,y:j.y},end:e}});return g},render:function(b,a,d){var c=this;c.renderer.setCanvas(b);c.draw({},a,d)},renderConnection:function(c,d,g,f){var e=this;var b=c.getNodes();var a=e.calculateEndPoints(b,g,c);e.render(d,a,f);return true},options:function(b){var a={shape:MEPH.util.Renderer.shapes.line,fillStyle:"grey",x:10,y:10,width:200,height:100,radius:4};for(var c in b){a[c]=b[c]}return a},drawToCache:function(c,b){b=b||{};var d=this,a=d.options(b);d.callParent.apply(d,[c,a])}});