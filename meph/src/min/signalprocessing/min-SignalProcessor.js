MEPH.define("MEPH.signalprocessing.SignalProcessor",{requires:["MEPH.math.FFT","MEPH.math.Util","MEPH.util.Vector","MEPH.math.Vector","MEPH.tween.Calculator"],statics:{MAX_FRAME_LENGTH:16000,maximumWindow:1024},properties:{windowingFunc:null,sampleRate:44100,joiningFunc:null,framesize:2048,lastphase:null,gInFIFO:null,gOutFIFO:null,gFFTworksp:null,gLastPhase:null,gSumPhase:null,gOutputAccum:null,gAnaFreq:null,gAnaMagn:null,gSynFreq:null,gSynMagn:null,gRover:null,gInit:null},initialize:function(b){var a=this;if(!b){a.clear()}},clear:function(){var a=this;a.gInFIFO=new Float32Array(MEPH.signalprocessing.SignalProcessor.MAX_FRAME_LENGTH);a.gOutFIFO=new Float32Array(MEPH.signalprocessing.SignalProcessor.MAX_FRAME_LENGTH);a.gFFTworksp=new Float32Array(2*MEPH.signalprocessing.SignalProcessor.MAX_FRAME_LENGTH);a.gLastPhase=new Float32Array(MEPH.signalprocessing.SignalProcessor.MAX_FRAME_LENGTH);a.gSumPhase=new Float32Array(MEPH.signalprocessing.SignalProcessor.MAX_FRAME_LENGTH);a.gOutputAccum=new Float32Array(MEPH.signalprocessing.SignalProcessor.MAX_FRAME_LENGTH);a.gAnaFreq=new Float32Array(MEPH.signalprocessing.SignalProcessor.MAX_FRAME_LENGTH);a.gAnaMagn=new Float32Array(MEPH.signalprocessing.SignalProcessor.MAX_FRAME_LENGTH);a.gSynFreq=new Float32Array(MEPH.signalprocessing.SignalProcessor.MAX_FRAME_LENGTH);a.gSynMagn=new Float32Array(MEPH.signalprocessing.SignalProcessor.MAX_FRAME_LENGTH)},pitchShift:function(b,q,z,A,a,r,u){var p,e,x,h,n,w;var o,g;var v,s,m,f,d,c,t;var y=this;u=u||r;var j=false;t=z/2;c=z/A;o=a/z;g=2*Math.PI*c/z;d=z-c;if(!y.gRover){y.gRover=d}for(v=0;v<q;v++){y.gInFIFO[y.gRover]=r[v];u[v]=y.gOutFIFO[y.gRover-d];y.gRover++;if(y.gRover>=z){y.gRover=d;for(s=0;s<z;s++){h=-0.5*Math.cos(2*Math.PI*s/z)+0.5;y.gFFTworksp[2*s]=(y.gInFIFO[s]*h);y.gFFTworksp[2*s+1]=0}y.ShortTimeFourierTransform(y.gFFTworksp,z,-1);for(s=0;s<=t;s++){n=y.gFFTworksp[2*s];w=y.gFFTworksp[2*s+1];p=2*Math.sqrt(n*n+w*w);e=Math.atan2(w,n);x=e-y.gLastPhase[s];y.gLastPhase[s]=e;x-=s*g;m=Math.floor(x/Math.PI);if(m>=0){m+=m&1}else{m-=m&1}x-=Math.PI*m;x=A*x/(2*Math.PI);x=s*o+x*o;y.gAnaMagn[s]=p;y.gAnaFreq[s]=x}for(var l=0;l<z;l++){y.gSynMagn[l]=0;y.gSynFreq[l]=0}for(s=0;s<=t;s++){f=Math.floor(s*b);if(f<=t){y.gSynMagn[f]+=y.gAnaMagn[s];y.gSynFreq[f]=y.gAnaFreq[s]*b}}for(s=0;s<=t;s++){p=y.gSynMagn[s];x=y.gSynFreq[s];x-=s*o;x/=o;x=2*Math.PI*x/A;x+=s*g;y.gSumPhase[s]+=x;e=y.gSumPhase[s];y.gFFTworksp[2*s]=(p*Math.cos(e));y.gFFTworksp[2*s+1]=(p*Math.sin(e))}for(s=z+2;s<2*z;s++){y.gFFTworksp[s]=0}y.ShortTimeFourierTransform(y.gFFTworksp,z,1);for(s=0;s<z;s++){h=-0.5*Math.cos(2*Math.PI*s/z)+0.5;y.gOutputAccum[s]+=(2*h*y.gFFTworksp[2*s]/(t*A));if(isNaN(y.gOutputAccum[s])){}}for(s=0;s<c;s++){y.gOutFIFO[s]=y.gOutputAccum[s]}j=true;for(s=0;s<z;s++){y.gOutputAccum[s]=y.gOutputAccum[s+c]}for(s=0;s<d;s++){y.gInFIFO[s]=y.gInFIFO[s+c]}}}return j},signalPitchShift:function(j,a,m,l,n){var d,h,c;c=m/2;var f,b;var g,e;var i=j.select(function(o){b=o.mag;e=o.freq;f=new Float32Array(m);g=new Float32Array(m);for(d=0;d<=c;d++){h=Math.floor(d*a);if(h<=c){f[h]+=b[d];g[h]=e[d]*a}}return{mag:f,freq:g}});return i},timeStretch:function(b,z,q,A,B,a,r,u){var p,e,x,h,n,w;var o,g;var v,s,m,f,d,c,t;var y=this;z=z||1;u=u||r;var j=false;t=A/2;c=A/B;o=a/A;g=2*Math.PI*c/A;d=A-c;if(!y.gRover){y.gRover=d}for(v=0;v<q;v++){y.gInFIFO[y.gRover]=r[v];u[v]=y.gOutFIFO[y.gRover-d];y.gRover++;if(y.gRover>=A){y.gRover=d;for(s=0;s<A;s++){h=-0.5*Math.cos(2*Math.PI*s/A)+0.5;y.gFFTworksp[2*s]=(y.gInFIFO[s]*h);y.gFFTworksp[2*s+1]=0}y.ShortTimeFourierTransform(y.gFFTworksp,A,-1);for(s=0;s<=t;s++){n=y.gFFTworksp[2*s];w=y.gFFTworksp[2*s+1];p=2*Math.sqrt(n*n+w*w);e=Math.atan2(w,n);x=e-y.gLastPhase[s];y.gLastPhase[s]=e;x-=s*g;m=Math.floor(x/Math.PI);if(m>=0){m+=m&1}else{m-=m&1}x-=Math.PI*m;x=B*x/(2*Math.PI);x=s*o+x*o;y.gAnaMagn[s]=p;y.gAnaFreq[s]=x}for(var l=0;l<A;l++){y.gSynMagn[l]=0;y.gSynFreq[l]=0}for(s=0;s<=t;s++){f=Math.floor(s*b);if(f<=t){y.gSynMagn[f]+=y.gAnaMagn[s];y.gSynFreq[f]=y.gAnaFreq[s]*b}}for(s=0;s<=t;s++){p=y.gSynMagn[s];x=y.gSynFreq[s];x-=s*o;x/=o;x=2*Math.PI*x/B;x+=s*g;y.gSumPhase[s]+=x;e=y.gSumPhase[s];y.gFFTworksp[2*s]=(p*Math.cos(e));y.gFFTworksp[2*s+1]=(p*Math.sin(e))}for(s=A+2;s<2*A;s++){y.gFFTworksp[s]=0}y.ShortTimeFourierTransform(y.gFFTworksp,A,1);for(s=0;s<A;s++){h=-0.5*Math.cos(2*Math.PI*s/A)+0.5;y.gOutputAccum[s]+=(2*h*y.gFFTworksp[2*s]/(t*B));if(isNaN(y.gOutputAccum[s])){}}for(s=0;s<c;s++){y.gOutFIFO[s]=y.gOutputAccum[s]}j=true;for(s=0;s<A;s++){y.gOutputAccum[s]=y.gOutputAccum[s+c]}for(s=0;s<d;s++){y.gInFIFO[s]=y.gInFIFO[s+c]}}}return j},signalAnalysis:function(A,B,a,p){var y=this;var r=A/2;var b=A/B;var n=a/A;var q;var f=2*Math.PI*b/A;var d=A-b;var C=[];var o,c,v,g,m,t;var n,f;var s,q,j,e,d,b,r;var y=this;var z;var l;var x;var w;var h;w=new Float32Array(2*A);var u=Math.ceil(p.length/b);h=new Float32Array(A);var C=[].interpolate(0,u,function(i){z=p.subset(i*b,(i*b)+A);l=new Float32Array(A);x=new Float32Array(A);for(q=0;q<A;q++){g=-0.5*Math.cos(2*Math.PI*q/A)+0.5;w[2*q]=(z[q]*g);w[2*q+1]=0}y.ShortTimeFourierTransform(w,A,-1);for(q=0;q<=r;q++){m=w[2*q];t=w[2*q+1];o=2*Math.sqrt(m*m+t*t);c=Math.atan2(t,m);v=c-h[q];h[q]=c;v-=q*f;j=Math.floor(v/Math.PI);if(j>=0){j+=j&1}else{j-=j&1}v-=Math.PI*j;v=B*v/(2*Math.PI);v=q*n+v*n;x[q]=o;l[q]=v}return{mag:x,freq:l}});return C},signalSynthesis:function(l,A,B,b){var q,d,x,h,o,v;var p,g;var u,r,m,f,e,c,s;var z=this;var j=false;s=A/2;c=A/B;p=b/A;g=2*Math.PI*c/A;var w=new Float32Array(A);var y=new Float32Array(2*A);var a=new Float32Array(A+c);var n=0;var t=new Float32Array(c*l.length);l.foreach(function(D){var i=D.mag;var C=D.freq;for(r=0;r<=s;r++){q=i[r];x=C[r];x-=r*p;x/=p;x=2*Math.PI*x/B;x+=r*g;w[r]+=x;d=w[r];y[2*r]=(q*Math.cos(d));y[2*r+1]=(q*Math.sin(d))}for(r=A+2;r<2*A;r++){y[r]=0}z.ShortTimeFourierTransform(y,A,1);for(r=0;r<A;r++){h=-0.5*Math.cos(2*Math.PI*r/A)+0.5;a[r]+=(2*h*y[2*r]/(s*B))}for(r=0;r<c;r++){t[r+n]=a[r]}j=true;n=c+n;for(r=0;r<A;r++){if(r+c>=a.length){MEPH.Log("outside of bounds")}a[r]=a[r+c]}});return t},modifySignal:function(a,e,i,g,j,d){var h;var c;var b=this;a=a||1;h=b.signalAnalysis(i,g,j,d);if(e&&e.length){c=b.timeScaling(h,e);h=c}if(a!==1){c=b.signalPitchShift(h,a,i,g,j);h=c}var f=b.signalSynthesis(h,i,g,j);return f},timeScaling:function(f,j){if(!j.length){throw new Error("Time scaling array does any elements.")}var g=f.length;var b=j.maximum(function(m){return m.start});var e=j.maximum(function(m){return m.scale});var l=(g)*e/b;var d=j.select(function(m){return m.start*(g-1)/b});var i=j.select(function(m){return m.scale*(g-1)/e});var h=function(o){var m=[{x:d.select(function(p){return p/(g-1)}),y:i.select(function(p){return p/(g-1)})}];var n=new MEPH.tween.Calculator();n.setData(m);return o.select(function(q){var p=n.get(q/(l-1));return p*(g-1)})};var c=h([].interpolate(0,Math.floor(l)));var a=[f[Math.round(c[0])]];c.subset(1).foreach(function(m){a.push(f[Math.round(m)])});return a},guessfrequencies:function(c,d,g,a,f){var e=this;var b=Math.ceil(c.length/g);var h=[].interpolate(0,b,function(i){var l=c.subset(g*i,(g*(i+1)));var j=e.guessfrequency(l,d,a,f);return j});return h},getNotes:function(b,c,f,a,e){var d=this,g=d.guessfrequencies(b,c,f,a,e);return g.select(function(h){return d.noteFromFrequency(h)})},noteFromPitch:function(a){var b=12*(Math.log(a/440)/Math.log(2));return Math.round(b)+69},noteFromFrequency:function(d){var b=this,a=b.noteFromPitch(d);var c=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return c[a%12]},guessfrequency:function(g,h,e,i){var d=this;var c=d.frequency(g,h,e,i);if(c.length>2){var f=c.maximum(function(j){return Math.abs(j)});var b=c.indexWhere(function(j){return Math.abs(j)===f}).first();c.splice(b,1);var f=c.maximum(function(j){return -Math.abs(j)});var b=c.indexWhere(function(j){return -Math.abs(j)===f}).first();c.splice(b,1)}var a=c.summation(function(j,l){return j+l})/c.length;return a},frequency:function(g,h,e,i){var d=this;var a=g.length;var c=a/2;e=e||1024;i=i||(e/2);var f=g.length/i;var b=[].interpolate(0,f,function(j){var m=g.subset(i*j,(i*(j))+e);if(m.length<e){m=[].interpolate(0,e,function(n){return m[n]||0})}var l=d._frequency(m,h);return l});return b},_frequency:function(c,d){var f=this;var e=f.fft(c);var b=e.maximum(function(h){return Math.abs(h)});var g=e.indexWhere(function(h){return Math.abs(h)===b}).first();var a=d/c.length*g;return a},ShortTimeFourierTransform:function(d,u,t){var c,g,f,s;var a,e,h,l;var q,r,o,m,b,n;for(q=2;q<2*u-2;q+=2){for(r=2,o=0;r<2*u;r<<=1){if((q&r)!=0){o++}o<<=1}if(q<o){s=d[q];d[q]=d[o];d[o]=s;s=d[q+1];d[q+1]=d[o+1];d[o+1]=s}}var p=Math.floor(Math.log(u)/Math.log(2)+0.5);for(n=0,m=2;n<p;n++){m<<=1;b=m>>1;h=1;l=0;f=Math.PI/(b>>1);c=Math.cos(f);g=(t*Math.sin(f));for(o=0;o<b;o+=2){for(q=o;q<2*u;q+=m){a=d[q+b]*h-d[q+b+1]*l;e=d[q+b]*l+d[q+b+1]*h;d[q+b]=d[q]-a;d[q+b+1]=d[q+1]-e;d[q]+=a;d[q+1]+=e}a=h*c-l*g;l=h*g+l*c;h=a}}},sfft:function(e,d,f,m){m=Math.ceil(m||0);var j=this;if(m<=0){throw new Error("Hop size is smaller than or equal to 0.")}var g=d.length;var i=Math.floor((g+1)/2);var h=Math.floor(g/2);var a=0;var c=e.length-g;var l=d.summation(function(p,q){return p+q});d=d.select(function(p){return p/l});var o=[];while(a<=c){var b=e.subset(a,a+g);var n=j.dfft(b,d);o.push(n);a+=m}return o},isfft:function(e,f,c){var d=this;var b=0;var a=new Float32Array(e.length*c);e.foreach(function(j,g){var h=d.idfft(j,f).skipEvery(2);h.foreach(function(m,l){a[b+l]+=m*c});b+=c});return a},idfft:function(c,b){var a=this;return a.ifft(c)},dfft:function(d,c){var b=this,a;a=d.select(function(e,f){return e*c[f]});return b.fft(a)},fft:function(e,g,a,h,d,c){g=g!==undefined?g:"real";var i=g==="real"?e.length*2:e.length;var b=new Float32Array(i);a=a!==undefined?a:0;h=h!==undefined?h:1;d=d!==undefined?d:0;c=c!==undefined?c:1;var f=new FFT();f.complex(g==="complex"?e.length/2:e.length,false);f.process(b,a,h,e,d,c,g);return b},ifft:function(e,a,h,d,c,g){g=g!==undefined?g:"complex";var i=e.length;var b=new Float32Array(g==="complex"?i:i*2);a=a!==undefined?a:0;h=h!==undefined?h:1;d=d!==undefined?d:0;c=c!==undefined?c:1;var f=new FFT();f.complex(b.length/2,true);f.process(b,a,h,e,d,c,false);b.foreach(function(l,j){b[j]=b[j]/(i/2)});return b},amplitude:function(a){var b=new Float32Array(a.length/2);[].interpolate(0,a.length/2,function(c){var d=c*2;b[c]=MEPH.math.Util.polar(a[d],a[d+1]).radius});return b},phase:function(a){var b=new Float32Array(a.length/2);[].interpolate(0,a.length/2,function(c){var d=c*2;b[c]=MEPH.math.Util.polar(a[d],a[d+1]).theta});return b},detectMaxima:function(f,a){var h=[];var d=0;a=a||1;var c=null;var j;for(var e=0;e<f.length;e++){j=f[e];c=j;var b=f.subset(e+1,e+a+1).where(function(i){if(i>=c){c=i}return i>=c});c=j;var g=f.subset(e-a,e).where(function(i){if(i>=c){c=i}return i>=c});if(b.length===0&&g.length===0){h.push(e);e+=a-1}}return h},detectMinima:function(f,a){var h=[];var d=0;a=a||1;var c=null;var j;for(var e=0;e<f.length;e++){j=f[e];c=j;var b=f.subset(e+1,e+a+1).where(function(i){if(i<=c){c=i}return i<=c});c=j;var g=f.subset(e-a,e).where(function(i){if(i<=c){c=i}return i<=c});if(b.length===0&&g.length===0){h.push(e);e+=a-1}}return h},frameSize:function(a){var b=this;if(a){b.framesize=a;b.framesize2=a/2}return b.framesize},oversampling:function(b){var a=this;if(b){a.oversample=b}return a.oversample},samplingRate:function(a){var b=this;if(a){b.samplingrate=a}return b.samplingrate},analysis:function(l){var i=this,a,o,j,m,p,f,e,n=i.samplingRate(),c,h=i.oversampling(),b;i.lastphase=i.lastphase||new Float32Array(i.framesize2);if(i.lastphase.length!==i.framesize2){i.lastphase=new Float32Array(i.framesize2)}p=i.frameSize()/h;m=2*Math.PI*p/i.frameSize();e=n/i.frameSize();var g={mag:new Float32Array(i.framesize2),freq:new Float32Array(i.framesize2)};for(var d=0;d<i.framesize2;d++){j=l[2*d];b=l[2*d+1];a=2*Math.sqrt(j*j+b*b);o=Math.atan2(b,j);f=o-i.lastphase[d];i.lastphase[d]=o;f-=d*m;c=f/Math.PI;if(c>=0){c+=(c&1)}else{c-=(c&1)}f-=Math.PI*c;f=h*f/(2*Math.PI);f=d*e+f*e;g.mag[d]=a;g.freq[d]=f}return g},pitch:function(g,e){var d=this,b,f=new Float32Array(d.frameSize()),a=new Float32Array(d.frameSize()),c;for(b=0;b<d.framesize2;b++){c=Math.floor(b*e);if(c<d.framesize2){f[c]+=g.mag[b];a[c]=g.freq[b]*e}}return{mag:f,freq:a}},synthesis:function(a){var e=this,b,d,h,f,g=e.samplingRate(),c;d=e.oversampling();h=e.frameSize()/d;f=2*Math.PI*h/e.frameSize();c=g/e.frameSize();e.sumPhase=e.sumPhase||new Float32Array(e.framesize2);if(e.sumPhase.length!==e.framesize2){e.sumPhase=new Float32Array(e.framesize2)}var i=new Float32Array(e.frameSize());for(b=0;b<e.framesize2;b++){magn=a.mag[b];tmp=a.freq[b];tmp-=b*c;tmp/=c;tmp=2*Math.PI*tmp/d;tmp+=b*f;e.sumPhase[b]+=tmp;phase=e.sumPhase[b];i[2*b]=magn*Math.cos(phase);i[2*b+1]=magn*Math.sin(phase)}return i},unwindow:function(f,b){var e=this,d,c,a;c=e.oversampling();for(a=0;a<e.frameSize();a++){d=-0.5*Math.cos(2*Math.PI*a/e.frameSize())+0.5;b[a]+=2*d*(f[2*a]||0)/(e.framesize2*c)}return b},unwrap:function(a,d,b){d=d||Math.PI;b=b||-1;var g=this;var c=a.length;var h=g.diff(a);var i=h.select(function(j){return(j+Math.PI)%(2*Math.PI)-Math.PI});i=i.select(function(j,l){return j===-Math.PI&&h[l]>0?Math.PI:j});var e=i.select(function(j,l){return j-h[l]});e=e.select(function(j,l){return Math.abs(h[l])<d?0:j});var f=e.cumsum();return a.select(function(j,l){return j+(f[l-1]||0)})},phaseunwrap:function(a){var b=this;var c=a.select();return b.unwrapImplGetter(c,0,1,1)},unwrapImplGetter:function(j,a,b,g){var l=Math.PI;var o=this;var c=o.modf(j,a),e=0;a+=b;for(var h=1;h<g;++h,a+=b){var f=o.modf(j,a);var m=f-c;if(m<-l){e+=tau}else{if(m>l){e-=tau}}j[a]=f+e;c=f}return j},modf:function(c,e){var d=Math.PI*2;var b=this;var a=c[e];if(c[e]<0){return d+(a%d)}else{if(a>d){return a%d}}return a},diff:function(c,b){b=b||1;var a=c.subset(1).select(function(d,e){return d-c[e]});if(b>1){b--;return me.diff(a,b)}return a},stretch:function(l,a,m,b,j){var f=l.length,i=this;m=m===null?0.5:m;var d=b||i.windowWidth(l.length);a=j==="complex"?a:a*2;var n=i.fftwindows(l,d);var h=n.select(function(o,p){return{a:o,b:n[p+1]||null}});var c=i.interpolateFrames(d*2,n,j==="complex"?a:a/2,m);var e=i.ifftwindows(c);var g=i.joinWindows(e,i.joining(),m,a*f);return g},interpolateFrames:function(z,u,t,d){var y=this,e,h,l,s,x,v,c,o,n,m,p,i,r,g,j=(1/(d||1)),A;A=y.generateWindows(z,Math.ceil(u.length*t*j));m=MEPH.util.Vector.Lerp;var e=u.first().phase.select();var f=z/2;var e=[].interpolate(0,u.first().phase.length,function(a){return u.select(function(b){return b.phase[a]})}).select(function(a){return y.unwrap(a)});var q=null,w=z*d;A.foreach(function(a,b){r=Math.floor(b/(t*j));i=Math.ceil(b/(t*j));g=(b/(t))-r;x=u[r];v=u[i];v=v||x;if(r>i){throw new Error("Frames are out of sequence.")}a.step(2,function(D,E){c=E/2;var G=e[c][r];var F=e[c][i];if(q){var C=(F-G)/(w);var B=MEPH.math.Util.polar(q[E],q[E+1]);var K=B.theta+C*t*d;G=K}var J=G;var I=m(x.amplitude[c],v.amplitude[c],g);var H=MEPH.math.Util.rectangular(J,I);a[E]=H.x;a[E+1]=H.y});q=a});return A},joinWindows:function(g,a,c,f){var e=g.first().length;c=c||1;var b=f;var d=new Float32Array(b);d.step(2,function(j,l){var i=g.indexWhere(function(p,q){var r=q*c*e;var o=r+e-1;return r<=l&&l<o});var h=i.select(function(p,q){var r=g[p];var s=Math.floor(p*c*e);var o=a(l-s,e);return{window:g[p],start:s,contribution:o<0?0:o}});var n=h.addition(function(o){return o.contribution});var m=h.addition(function(q,p){var o=q.window;return n===0?o[l-q.start]:(q.contribution/n)*o[l-q.start]});d[l]=m;m=h.addition(function(q,p){var o=q.window;return(q.contribution/n)*o[(l+1)-q.start]});d[l+1]=m});return d},fftwindows:function(e,d){var c=this;var f=c.windowing();if(!f){throw new Error("Set a windowing function.")}var b=Math.ceil(e.length/d);var a=[].interpolate(0,b,function(i){var g=i*d;var h=(i+1)*d;var j=e.subset(g,h);var l=c.fft(j);return{raw:l,phase:c.phase(l),amplitude:c.amplitude(l)}});return a},ifftwindows:function(c){var b=this;var a=c.select(function(d){return b.ifft(d)});return a},generateWindows:function(a,b){return[].interpolate(0,b,function(c){return new Float32Array(a)})},windowWidth:function(a){var b=Math.log(a)/Math.log(2);return Math.pow(2,Math.min(MEPH.signalprocessing.SignalProcessor.maximumWindow,Math.max(2,(b/2))))},windowing:function(a){var b=this;if(a!==undefined){b.windowingFunc=a}return b.windowingFunc},joining:function(a){var b=this;if(a!==undefined){b.windowingFunc=a}return b.windowingFunc},interleaveInput:function(b){var e=this,d,c=e.frameSize(),a=e.getArray(b,c*2);for(k=0;k<e.frameSize();k++){d=-0.5*Math.cos(2*Math.PI*k/c)+0.5;a[2*k]=b[k]*d;a[2*k+1]=0}return a},getArray:function(b,a){if(b instanceof Float32Array){return new Float32Array(a)}else{if(b instanceof Float64Array){return new Float64Array(a)}}return[].interpolate(0,a,function(){return 0})},peakDetection:function(a,f){var d=this;var c=(f);var g=a.select(function(i){return(i)});var h=g.subset(1,g.length-1).indexWhere(function(i){return(i)>(c)});var e=g.subset(1,g.length-1).indexWhere(function(j,l){return(j)>(g[l])&&(j)>(g[l+2])}).select(function(i){return i+1});var b=e.where(function(i){return h.some(function(j){return j===i})});return b},toDb:function(a){return 20*Math.log(Math.abs(a))/Math.log(10)},fromDb:function(a){return Math.pow(10,a/20)},peakInterp:function(f,b,a){var e=this;var c=a.select(function(n,h){var m=(f[n]);var i=(f[n-1]);var l=(f[n+1]);var j=n+0.5*(i-l)/(i-(2*m)+l);return j});var g=a.select(function(n,i){var m=(f[n]);var j=(f[n-1]);var l=(f[n+1]);var h=m-0.25*(j-l)*(c[i]-n);return h});var d=a.select(function(i,h){return MEPH.math.Vector.lerp(b[i],b[i+1],0.5)});return{locations:c,magnitudes:g,phases:d}},sineModelAnal:function(o,i,s,j,r,f,B,q,a,e){B=B||811;q=q||0.001;a=a||20;e=e||0.3;var M=this;if(q<0){throw new Error("Minimum duration of sine tracks smaller than 0")}var A=Math.floor((s.length+1)/2);var z=Math.floor((s.length/2));var g=new Float32Array(o.length+z+A);o.foreach(function(x,w){g[w+z]=x});o=g;var l=A;var K=o.length-A;s=s.normalize();var J=[];var u,n,C;while(l<K){var I=o.subset(l-A,l+z,function(w){return w});var c=M.dftAnal(I,s,j);var b=M.peakDetection(c.mX,f);var G=b.select(function(w){return c.mX[w]});var D=M.peakInterp(c.mX,c.pX,b);var L=D.locations;var p=D.magnitudes;var v=D.phases;var d=L.select(function(w){return(i*w/j)});var h=M.sineTracking(d,p,v,J,a,e);J=h.tfreq;var m=h.tmag;var t=h.tphase;J=J.subset(0,B);m=m.subset(0,B);t=t.subset(0,B);var E=[].zeroes(B);var F=[].zeroes(B);var y=[].zeroes(B);J.foreach(function(w,H){E[H]=w});m.foreach(function(w,H){F[H]=w});t.foreach(function(w,H){y[H]=w});if(l===A){u=[E.select()];n=[F.select()];C=[y.select()]}else{u.push(E.select());n.push(F.select());C.push(y.select())}l+=r}u=M.cleaningSineTracks(u,Math.round(i*q/r));return{tfreq:u,tmag:n,tphase:C}},sineModelSynth:function(b,e,g,l,r,j){var n=this;var h=l/2;var m=b.length;var c=0;var i=r*(m+3);var o=new Float32Array(i);var q=[].zeroes(l);var d=MEPH.math.Util.window.Triang(null,r*2);d.foreach(function(u,s){q[h-r+s]=u});var f=[].interpolate(0,l,function(s){return MEPH.math.Util.window.BlackmanHarris(s,l)});f=f.normalize();[].interpolate(h-r,h+r,function(s){q[s]=q[s]/f[s]});var p=b[0].select();var a=[].interpolate(0,p.length,function(s){return 2*Math.PI*Math.random()});[].interpolate(0,m,function(t){if(g[t]){a=g[t].select()}else{a=a.select(function(w,v){return a[v]+(Math.PI*(p[v]+b[t][v])/j)*r})}var u=n.genSpecSines(b[t],e[t],a,l,j);p=b[t].select();a=a.select(function(v){return v%(2*Math.PI)});g.push(a);var s=n.ifft(u.Y).skipEvery(2).fftshift();[].interpolate(c,c+l,function(v,w){o[v]+=q[w]*s[w]});c+=r});o=o.subset(h,o.length-h);return o},sineTimeScaling:function(a,d,l){if(!l.length){throw new Error("Time scaling array does any elements.")}var h=a.length;var c=l.maximum(function(o){return o.start});var g=l.maximum(function(o){return o.scale});var m=(h)*g/c;var f=l.select(function(o){return o.start*(h-1)/c});var j=l.select(function(o){return o.scale*(h-1)/g});var i=function(q){var o=[{x:f.select(function(r){return r/(h-1)}),y:j.select(function(r){return r/(h-1)})}];var p=new MEPH.tween.Calculator();p.setData(o);return q.select(function(s){var r=p.get(s/(m-1));return r*(h-1)})};var e=i([].interpolate(0,m));var b=[a[Math.round(e[0])]];var n=[d[Math.round(e[0])]];e.subset(1).foreach(function(o){b.push(a[Math.round(o)]);n.push(d[Math.round(o)])});return{tfreq:b,tmag:n}},sineFreqScaling:function(a,e){var h=this;if(!e.length){throw new Error("Frequency scaling array does any elements.")}var i=a.length;var c=e.maximum(function(m){return m.start});var g=e.maximum(function(m){return m.scale});var l=(i)*g/c;var f=e.select(function(m){return m.start*(i-1)/c});var j=e.select(function(m){return m.scale*(i-1)/g});var d=function(o){var m=[{x:f.select(function(p){return p/(i-1)}),y:j.select(function(p){return p/(i-1)})}];var n=new MEPH.tween.Calculator();n.setData(m);return o.select(function(q){var p=n.get(q/(l-1));return p})};var e=d([].interpolate(0,l));var b=[];e.foreach(function(o,m){var n=a[m].select(function(p){return p+p*o});b.push(n)});return b},sineModel:function(n,h,p,j,q,a){var F=this;var A=Math.floor((p.length+1)/2);var z=Math.floor(p.length/2);var d=a||512;var o=d/4;var u=d/2;var l=Math.max(u,A);var E=n.length-l;var B=new Float32Array(j);var v=new Float32Array(d);var m=new Float32Array(n.length);var D=p.summation(function(x,w){return x+w});p=p.select(function(w){return w/D});var s=new Float32Array(d);var g=MEPH.math.Util.window.Triang(null,o*2);g.foreach(function(x,w){s[u-o+w]=x});var e=[].interpolate(0,j,function(t){return MEPH.math.Util.window.BlackmanHarris(t,j)});e.normalize();[].interpolate(hN-o,hN+o,function(w){s[w]=s[w]/e[w]});while(l<E){var r=n.subset(l-A,l+z,function(w){return w});var i=F.dftAnal(x1,p,j);var c=F.peakDetection(i.mX,q);var C=c.select(function(w){return i.mX[w]});var G=F.peakInterp(i.mX,i.pX,c);var f=G.iploc.select(function(w){return h*w/j});var b=F.genSpecSines(f,G.ipmag,G.ipphase,d,h);var v=F.dftSynth(b,p);[].interpolate(l-u,l+u,function(x,w){m[x]+=s[w]*v[w]});l+=o}return m},cleaningSineTracks:function(b,a){a=a||3;if(b.length===0){return b}var g=b.length;var e=b[0].length;var d=[].interpolate(0,e,function(h){return[].interpolate(0,g,function(i){if(b[i][h]){if(i===0){return{track:h,frame:i}}else{if(i>0&&b[i-1][h]===0){return{track:h,frame:i}}}}}).where()}).concatFluent(function(h){return h});var c=[].interpolate(0,e,function(h){return[].interpolate(0,g,function(i){if(b[i][h]){if(i===g-1){return{track:h,frame:i}}else{if(b[i+1][h]===0){return{track:h,frame:i}}}}}).where()}).concatFluent(function(h){return h});d.foreach(function(h){var i=c.first(function(j){return j.track===h.track&&j.frame>h.frame});if(i){h.end=i.frame;h.length=i.frame-h.frame}});var f=d.where(function(h){return h.length<a});f.foreach(function(h){[].interpolate(h.frame,h.end+1,function(i){b[i][h.track]=0})});return b},sineTracking:function(h,p,v,q,a,f){a=a||20;f=f||0.01;var u=this,c=[].zeroes(q.length),e=[].zeroes(q.length),j=[].zeroes(q.length),n=h.indexWhere(function(w){return w}),d=[].interpolate(0,q.length,function(w){return w}),s=[].interpolate(0,q.length,function(){return -1}),g=n.argsort(function(w,z){return Math.abs(p[z])-Math.abs(p[w])}),i=h.select(),l=p.select(),m=v.select();if(d.length>0){g.foreach(function(y){if(d.length){var x=d.closestAbs(i[y],function(z){var A=q[d[z]];return A});var w=Math.abs(Math.abs(h[y])-Math.abs(q[d[x]]));if(w<(a+f*h[y])){s[d[x]]=y;d.splice(x,1)}}})}var r=s.indexWhere(function(w){return w!==-1});if(r.length>0){var t=r.select(function(w){return s[w]});t.foreach(function(x,w){c[r[w]]=i[x];e[r[w]]=l[x];j[r[w]]=m[x]});i.removeIndices(t);l.removeIndices(t);m.removeIndices(t)}var b=q.indexWhere(function(w){return w===0});var o=l.argsort(function(w,z){return Math.abs(z)-Math.abs(w)});if(o.length>0&&b.length>=o.length){o.foreach(function(x,w){c[b[w]]=i[x];e[b[w]]=l[x];j[b[w]]=m[x]})}else{if(o.length>0&&b.length<o.length){b.foreach(function(x,w){c[x]=i[o[w]];e[x]=l[o[w]];j[x]=m[o[w]]});[].interpolate(b.length,o.length,function(w){c.push(i[o[w]]);e.push(l[o[w]]);j.push(m[o[w]])})}}return{tfreq:c,tmag:e,tphase:j}},dftAnal:function(l,m,g){if(m.length>g){throw new Error("Window size (M) is bigger than FFT size")}var j=this;var f=(g/2)+1;var i=Math.floor((m.length+1)/2);var h=Math.floor(m.length/2);var c=[].zeroes(g);m=m.normalize();var a=l.select(function(o,n){return o*m[n]});[].interpolate(0,i,function(n){c[n]=a[h+n]});[].interpolate(0,h,function(n){c[c.length-h+n-1]=a[n]});var b=j.fft(c);var e=b.skipEvery(2).select(function(n,p){var o=MEPH.math.Util.polar(b[p*2],b[p*2+1]).radius;return j.toDb(o)}).subset(0,f);var d=j.unwrap(b.subset(1).skipEvery(2).select(function(n,o){return MEPH.math.Util.polar(b[o*2],n).theta})).subset(0,f);return{mX:e,pX:d}},dftSynth:function(d,h){var f=d.mX;var b=d.pX;var e=f.length;var c=this;var g=new Float32Array(e*2);f.foreach(function(j,l){g[l*2]=j;g[l*2+1]=b[l]});var a=c.ifft(g).skipEvery(2);return a},genSpecSines2:function(h,c,b,g,f){var i=this;var a=[].zeroes(g);var d=[].zeroes(g);var e=g/2;[].interpolate(0,h.length,function(n){var p=g*h[n]/f;if(p!==0&&p<=e-1){var m=Math.round(p)-p;var o=[].interpolate(m-4,m+5,function(q){return q});var l=i.genBhLobe(o).select(function(q){return q*c[n]});var j=[].interpolate(Math.round(p)-4,Math.round(p)+5);[].interpolate(0,9,function(q){if(j[q]<0){a[-j[q]]+=l[q]}})}})},genBhLobe:function(b,a){return MEPH.math.Util.getBhLobe(b,a)},genSpecSines:function(j,d,b,i,h){var l=this;var a=new Float32Array(i);var f=new Float32Array(i);var g=i/2;var e=j.select(function(n){var o=i*n/h;return o}).where().where(function(n){return n<=g-1});l.$getSpecSines(e,d,b,e.length,a,f,i);var c=new Float32Array(f.length*2);var m=[].interpolate(0,f.length,function(o,n){return[a[n],f[n]]}).concatFluent(function(n){return n});m.foreach(function(o,n){c[n]=o});return{mX:a,pX:f,Y:c}},$$getSpecSines:function(u,j,q,s,i,r,e){var w=this,t;var p=e/2;var c=Math.cos;var a=Math.sin;for(var h=0;h<s;h++){var f=u[h];var g=Math.floor(f+0.5)-f;var n=[].interpolate(g-4,g+5);var o=w.genBhLobe(n,e);var v=[].interpolate(Math.round(f)-4,Math.round(f)+5,function(b){return b});var d=j[h];for(var l=0;l<9;l++){if(v[l]<0){i[-v[l]]+=d*o[l]*c(q[h]);r[-v[l]]+=-1*d*o[l]*a(q[h])}else{if(v[l]>p){i[v[l]]+=d*o[l]*c(q[h]);r[v[l]]+=-1*d*o[l]*a(q[h])}else{if(v[l]===0||v[l]===p){if(v[l]===0){i[v[l]]+=2*d*o[l]*c(q[h])}else{i[v[l]]+=2*d*o[l]*c(q[h])}}else{i[v[l]]+=d*o[l]*c(q[h]);r[v[l]]+=d*o[l]*a(q[h])}}}}}for(h=1;h<p;h++){i[p+h]=i[p-h];r[p+h]=-1*r[p-h]}},$getSpecSines:function(t,l,n,p,j,o,m){var h=0,q=0,i=MEPH.signalprocessing.SignalProcessor.bh_92_1001,s=MEPH.signalprocessing.SignalProcessor.BH_SIZE_BY2,r;var u=this;var e=Math.floor(m/2);var g,b=Math.cos,a=Math.sin,d=Math.pow,f,c;for(h=0;h<p;h++){f=t[h];g=Math.floor(f+0.5)-f;r=Math.floor(f+0.5);if((f>=5)&&(f<e-4)){c=u.fromDb(l[h]);for(q=-4;q<5;q++){j[r+q]+=c*i[Math.floor((g+q)*100)+s]*b(n[h]);o[r+q]+=c*i[Math.floor((g+q)*100)+s]*a(n[h])}}else{if((f>0)&&(f<5)){c=u.fromDb(l[h]);for(q=-4;q<5;q++){if(r+q<0){j[-1*(r+q)]+=c*i[Math.floor((g+q)*100)+s]*b(n[h]);o[-1*(r+q)]+=-1*c*i[Math.floor((g+q)*100)+s]*a(n[h])}else{if(r+q==0){j[(r+q)]+=2*c*i[Math.floor((g+q)*100)+s]*b(n[h])}else{j[(r+q)]+=c*i[Math.floor((g+q)*100)+s]*b(n[h]);o[r+q]+=c*i[Math.floor((g+q)*100)+s]*a(n[h])}}}}else{if((f>=e-4)&&(f<e-1)){c=u.fromDb(l[h]);for(q=-4;q<5;q++){if(r+q>e){j[m-(r+q)]+=c*i[Math.floor((g+q)*100)+s]*b(n[h]);o[m-(r+q)]+=-1*c*i[Math.floor((g+q)*100)+s]*a(n[h])}else{if(r+q==e){j[(r+q)]+=2*c*i[Math.floor((g+q)*100)+s]*b(n[h])}else{j[(r+q)]+=c*i[Math.floor((g+q)*100)+s]*b(n[h]);o[r+q]+=c*i[Math.floor((g+q)*100)+s]*a(n[h])}}}}}}}for(h=1;h<e;h++){j[e+h]=j[e-h];o[e+h]=-1*o[e-h]}}}).then(function(){MEPH.signalprocessing.SignalProcessor.bh_92_1001=[0.000008876,0.0000095606,0.000010255,0.000010956,0.000011664,0.000012376,0.00001309,0.000013804,0.000014516,0.000015224,0.000015927,0.00001662,0.000017303,0.000017973,0.000018628,0.000019265,0.000019881,0.000020475,0.000021045,0.000021586,0.000022098,0.000022578,0.000023022,0.00002343,0.000023798,0.000024124,0.000024406,0.000024642,0.000024829,0.000024966,0.000025051,0.000025081,0.000025055,0.000024971,0.000024828,0.000024625,0.00002436,0.000024032,0.000023642,0.000023187,0.000022668,0.000022085,0.000021437,0.000020726,0.000019952,0.000019116,0.00001822,0.000017264,0.000016253,0.000015186,0.000014069,0.000012904,0.000011694,0.000010445,0.0000091607,0.0000078463,0.0000065078,0.0000051516,0.0000037846,0.0000024143,0.0000010491,3.0242e-7,0.0000016305,0.000002925,0.0000041749,0.0000053683,0.0000064929,0.0000075353,0.000008481,0.0000093154,0.000010022,0.000010584,0.000010984,0.000011202,0.000011219,0.000011013,0.000010564,0.0000098468,0.0000088379,0.0000075115,0.0000058412,0.0000037985,0.0000013548,0.0000015209,0.0000048605,0.0000086968,0.000013065,0.000018002,0.000023544,0.00002973,0.000036602,0.000044202,0.000052573,0.000061761,0.000071816,0.000082779,0.00009471,0.00010766,0.00012167,0.00013682,0.00015315,0.00017072,0.0001896,0.00020986,0.00023155,0.00025474,0.00027951,0.00030592,0.00033406,0.00036401,0.00039582,0.00042959,0.0004654,0.00050335,0.0005435,0.00058595,0.00063081,0.00067816,0.00072811,0.00078076,0.0008362,0.00089452,0.00095588,0.0010203,0.001088,0.0011591,0.0012336,0.0013117,0.0013935,0.0014791,0.0015687,0.0016625,0.0017604,0.0018628,0.0019696,0.0020811,0.0021974,0.0023187,0.0024451,0.0025767,0.0027137,0.0028564,0.0030048,0.0031592,0.0033195,0.003486,0.0036593,0.0038388,0.0040255,0.004219,0.0044196,0.0046273,0.0048431,0.0050664,0.0052977,0.005537,0.0057848,0.0060412,0.0063063,0.0065804,0.0068638,0.0071565,0.0074591,0.0077713,0.0080938,0.0084265,0.00877,0.0091241,0.0094893,0.0098661,0.010254,0.010654,0.011066,0.01149,0.011927,0.012377,0.01284,0.013315,0.013805,0.014309,0.014827,0.015359,0.015906,0.016468,0.017045,0.017637,0.018246,0.01887,0.019511,0.020169,0.020844,0.021536,0.022245,0.022973,0.023718,0.024482,0.025264,0.026066,0.026887,0.027728,0.028589,0.02947,0.030371,0.031294,0.032237,0.033201,0.03419,0.035198,0.03623,0.037285,0.03836,0.039461,0.040587,0.041734,0.042906,0.044103,0.045324,0.046571,0.047845,0.049141,0.050468,0.051817,0.053194,0.054598,0.056031,0.057491,0.058976,0.060492,0.062036,0.063608,0.065211,0.066842,0.068501,0.070191,0.071912,0.073664,0.075443,0.077257,0.079099,0.080975,0.082882,0.08482,0.086792,0.088794,0.090832,0.0929,0.095002,0.097135,0.099305,0.10151,0.10375,0.10602,0.10832,0.11066,0.11304,0.11545,0.11789,0.12037,0.12289,0.12544,0.12803,0.13065,0.13331,0.13601,0.13874,0.14151,0.14431,0.14715,0.15003,0.15295,0.1559,0.15889,0.16192,0.16498,0.16808,0.17122,0.1744,0.17761,0.18086,0.18415,0.18747,0.19083,0.19424,0.19767,0.20115,0.20466,0.20821,0.21179,0.21542,0.21907,0.22277,0.22651,0.23028,0.23408,0.23793,0.24181,0.24572,0.24967,0.25366,0.25769,0.26175,0.26584,0.26996,0.27413,0.27833,0.28256,0.28683,0.29113,0.29546,0.29983,0.30423,0.30866,0.31313,0.31762,0.32215,0.32671,0.3313,0.33592,0.34057,0.34525,0.34996,0.35471,0.35948,0.36426,0.36909,0.37393,0.37883,0.38373,0.38866,0.39362,0.39858,0.4036,0.40863,0.41368,0.41873,0.42385,0.42897,0.43411,0.43926,0.44444,0.44962,0.45486,0.46006,0.46534,0.47061,0.47588,0.48118,0.48648,0.49181,0.49715,0.50251,0.50788,0.51324,0.51863,0.52403,0.52942,0.53485,0.54028,0.5457,0.55113,0.55655,0.56201,0.56744,0.57289,0.57835,0.58381,0.58923,0.59469,0.60015,0.60557,0.61103,0.61646,0.62191,0.62734,0.63277,0.63816,0.64359,0.64898,0.65438,0.65974,0.66511,0.67047,0.6758,0.68114,0.68644,0.69174,0.69701,0.70225,0.70749,0.71273,0.71794,0.72312,0.72826,0.73338,0.7385,0.74358,0.74864,0.75366,0.75868,0.76364,0.7686,0.7735,0.7784,0.78324,0.78804,0.79285,0.79759,0.80231,0.80696,0.81161,0.8162,0.82076,0.82528,0.82978,0.83421,0.83861,0.84296,0.84727,0.85151,0.85573,0.85992,0.86404,0.8681,0.87213,0.8761,0.88004,0.88391,0.88773,0.89148,0.8952,0.89886,0.90246,0.90602,0.90952,0.91294,0.91632,0.91963,0.92289,0.92611,0.92924,0.93231,0.93532,0.9383,0.94118,0.944,0.94676,0.94946,0.9521,0.95467,0.95718,0.9596,0.96199,0.96428,0.96651,0.96868,0.97076,0.97278,0.97473,0.97662,0.97845,0.98019,0.98186,0.98344,0.98499,0.98642,0.98781,0.98912,0.99036,0.99154,0.99262,0.99361,0.99457,0.99541,0.99622,0.99693,0.99758,0.99814,0.99864,0.99904,0.99938,0.99966,0.99984,0.99994,1,0.99994,0.99984,0.99966,0.99938,0.99904,0.99864,0.99814,0.99758,0.99693,0.99622,0.99541,0.99457,0.99361,0.99262,0.99154,0.99036,0.98912,0.98781,0.98642,0.98499,0.98344,0.98186,0.98019,0.97845,0.97662,0.97473,0.97278,0.97076,0.96868,0.96651,0.96428,0.96199,0.9596,0.95718,0.95467,0.9521,0.94946,0.94676,0.944,0.94118,0.9383,0.93532,0.93231,0.92924,0.92611,0.92289,0.91963,0.91632,0.91294,0.90952,0.90602,0.90246,0.89886,0.8952,0.89148,0.88773,0.88391,0.88004,0.8761,0.87213,0.8681,0.86404,0.85992,0.85573,0.85151,0.84727,0.84296,0.83861,0.83421,0.82978,0.82528,0.82076,0.8162,0.81161,0.80696,0.80231,0.79759,0.79285,0.78804,0.78324,0.7784,0.7735,0.7686,0.76364,0.75868,0.75366,0.74864,0.74358,0.7385,0.73338,0.72826,0.72312,0.71794,0.71273,0.70749,0.70225,0.69701,0.69174,0.68644,0.68114,0.6758,0.67047,0.66511,0.65974,0.65438,0.64898,0.64359,0.63816,0.63277,0.62734,0.62191,0.61646,0.61103,0.60557,0.60015,0.59469,0.58923,0.58381,0.57835,0.57289,0.56744,0.56201,0.55655,0.55113,0.5457,0.54028,0.53485,0.52942,0.52403,0.51863,0.51324,0.50788,0.50251,0.49715,0.49181,0.48648,0.48118,0.47588,0.47061,0.46534,0.46006,0.45486,0.44962,0.44444,0.43926,0.43411,0.42897,0.42385,0.41873,0.41368,0.40863,0.4036,0.39858,0.39362,0.38866,0.38373,0.37883,0.37393,0.36909,0.36426,0.35948,0.35471,0.34996,0.34525,0.34057,0.33592,0.3313,0.32671,0.32215,0.31762,0.31313,0.30866,0.30423,0.29983,0.29546,0.29113,0.28683,0.28256,0.27833,0.27413,0.26996,0.26584,0.26175,0.25769,0.25366,0.24967,0.24572,0.24181,0.23793,0.23408,0.23028,0.22651,0.22277,0.21907,0.21542,0.21179,0.20821,0.20466,0.20115,0.19767,0.19424,0.19083,0.18747,0.18415,0.18086,0.17761,0.1744,0.17122,0.16808,0.16498,0.16192,0.15889,0.1559,0.15295,0.15003,0.14715,0.14431,0.14151,0.13874,0.13601,0.13331,0.13065,0.12803,0.12544,0.12289,0.12037,0.11789,0.11545,0.11304,0.11066,0.10832,0.10602,0.10375,0.10151,0.099305,0.097135,0.095002,0.0929,0.090832,0.088794,0.086792,0.08482,0.082882,0.080975,0.079099,0.077257,0.075443,0.073664,0.071912,0.070191,0.068501,0.066842,0.065211,0.063608,0.062036,0.060492,0.058976,0.057491,0.056031,0.054598,0.053194,0.051817,0.050468,0.049141,0.047845,0.046571,0.045324,0.044103,0.042906,0.041734,0.040587,0.039461,0.03836,0.037285,0.03623,0.035198,0.03419,0.033201,0.032237,0.031294,0.030371,0.02947,0.028589,0.027728,0.026887,0.026066,0.025264,0.024482,0.023718,0.022973,0.022245,0.021536,0.020844,0.020169,0.019511,0.01887,0.018246,0.017637,0.017045,0.016468,0.015906,0.015359,0.014827,0.014309,0.013805,0.013315,0.01284,0.012377,0.011927,0.01149,0.011066,0.010654,0.010254,0.0098661,0.0094893,0.0091241,0.00877,0.0084265,0.0080938,0.0077713,0.0074591,0.0071565,0.0068638,0.0065804,0.0063063,0.0060412,0.0057848,0.005537,0.0052977,0.0050664,0.0048431,0.0046273,0.0044196,0.004219,0.0040255,0.0038388,0.0036593,0.003486,0.0033195,0.0031592,0.0030048,0.0028564,0.0027137,0.0025767,0.0024451,0.0023187,0.0021974,0.0020811,0.0019696,0.0018628,0.0017604,0.0016625,0.0015687,0.0014791,0.0013935,0.0013117,0.0012336,0.0011591,0.001088,0.0010203,0.00095588,0.00089452,0.0008362,0.00078076,0.00072811,0.00067816,0.00063081,0.00058595,0.0005435,0.00050335,0.0004654,0.00042959,0.00039582,0.00036401,0.00033406,0.00030592,0.00027951,0.00025474,0.00023155,0.00020986,0.0001896,0.00017072,0.00015315,0.00013682,0.00012167,0.00010766,0.00009471,0.000082779,0.000071816,0.000061761,0.000052573,0.000044202,0.000036602,0.00002973,0.000023544,0.000018002,0.000013065,0.0000086968,0.0000048605,0.0000015209,0.0000013548,0.0000037985,0.0000058412,0.0000075115,0.0000088379,0.0000098468,0.000010564,0.000011013,0.000011219,0.000011202,0.000010984,0.000010584,0.000010022,0.0000093154,0.000008481,0.0000075353,0.0000064929,0.0000053683,0.0000041749,0.000002925,0.0000016305,3.0242e-7,0.0000010491,0.0000024143,0.0000037846,0.0000051516,0.0000065078,0.0000078463,0.0000091607,0.000010445,0.000011694,0.000012904,0.000014069,0.000015186,0.000016253,0.000017264,0.00001822,0.000019116,0.000019952,0.000020726,0.000021437,0.000022085,0.000022668,0.000023187,0.000023642,0.000024032,0.00002436,0.000024625,0.000024828,0.000024971,0.000025055,0.000025081,0.000025051,0.000024966,0.000024829,0.000024642,0.000024406,0.000024124,0.000023798,0.00002343,0.000023022,0.000022578,0.000022098,0.000021586,0.000021045,0.000020475,0.000019881,0.000019265,0.000018628,0.000017973,0.000017303,0.00001662,0.000015927,0.000015224,0.000014516,0.000013804,0.00001309,0.000012376,0.000011664,0.000010956,0.000010255,0.0000095606,0.000008876,0.0000082026,0.0000075422,0.0000068957,0.000006265,0.0000056514,0.0000050561,0.00000448,0.0000039244,0.0000033905,0.0000028791,0.0000023909,0.0000019268,0.0000014875,0.0000010735,6.8548e-7,3.2373e-7];MEPH.signalprocessing.SignalProcessor.BH_SIZE=1001;MEPH.signalprocessing.SignalProcessor.BH_SIZE_BY2=501;MEPH.signalprocessing.SignalProcessor.MFACTOR=100});