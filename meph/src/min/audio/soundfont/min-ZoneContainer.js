MEPH.define("MEPH.audio.soundfont.ZoneContainer",{requires:["MEPH.audio.soundfont.chunks.data.ZoneRecord","MEPH.audio.soundfont.chunks.data.GeneratorRecord","MEPH.audio.soundfont.Zone","MEPH.audio.soundfont.chunks.data.operators.Operator","MEPH.audio.soundfont.chunks.data.operators.RangeOperator"],extend:"MEPH.audio.soundfont.SFObject",statics:{},properties:{record:null,_zoneClass:null,_globalZone:null,_zones:null},initialize:function(c,b,a){this._zones=[];this._zoneClass=Zone;this.callParent(c);this.nonSerializedProperties.push("record");this._zoneClass=a;this.record=b},getId:function(){return this.record.id},getName:function(){return this.record.name},getIndex:function(){return this.record.index},getZone:function(j,c){var f=128;var b=128;var h;for(var d=0;d<this._zones.length;d++){var g=this._zones[d];if(g.fits(j,c)){return g}var e=Math.abs(j-g.keyRange.low);e=Math.min(e,Math.abs(j-g.keyRange.high));var a=Math.abs(c-g.velRange.low);a=Math.min(a,Math.abs(c-g.velRange.high));if(e<b){b=e;f=a;h=g}else{if(e==b){if(a<f){f=a;h=g}}}}return h},buildZones:function(a){if(this.record.generators){for(var b=0;b<this.record.generators.length;b++){var c=this.record.generators[b];this.buildZone(c,a)}}},toXML:function(){return"overridden zonecontainer"},buildZone:function(e,c){var a=new this._zoneClass();if(e.operators){for(var d in e.operators){var b=e.operators[d];if(b instanceof RangeOperator){a[b.getName()]=b.getValues()}else{if(!b.getIsUnusedType()){a[b.getName()]=b.amount}}}}return a}});