MEPH.define("MEPH.audio.music.theory.Scales",{alias:"theory_scales",alternateNames:["TheoryScales"],requires:["MEPH.audio.music.theory.data.Voices"],scripts:["MEPH.audio.music.theory.data.ChordData"],statics:{init:function(){var c=MEPH.audio.music.theory.Scales;if(c.completedScales){return c.completedScales}var b=c.getVoices();var a=c.invertVoices(b);c.completedScales=c.complete(a);return c.completedScales},getScales:function(){var b=[];for(var a in TheoryScales.scales){if(TheoryScales.scales.hasOwnProperty(a)){TheoryScales.scales[a].id=TheoryScales.scales[a].id||MEPH.GUID();b.push(TheoryScales.scales[a])}}return b},getNotesInScale:function(e,d,c){var b=TheoryScales.getScale(e);var a=[].interpolate(d,c,function(f){var h=(f-d)%12;var g=b.base12.first(function(i){return i===h});if(g!==null){return f}return -1}).where(function(f){return f!==-1});return a},getScale:function(b){var a=TheoryScales.getScales();return a.first(function(c){return c.id===b})},getChordData:function(){var a=MEPH.getTemplate("MEPH.audio.music.theory.data.ChordData").template;return JSON.parse(a)},getVoices:function(){return MEPH.audio.music.theory.data.Voices.voiceList},createScaleArray:function(e,b,d){var a=[];for(var c=0;c<e.length;c++){a.push((e[c]+b)%d)}return a},getScaleById:function(d){var c=MEPH.audio.music.theory.Scales;bosslist=c.bossList();for(var b in bosslist){var a=bosslist[b].first(function(e){return e.id===d});if(a){return a}}return null},bossList:function(){var a={},c=0,g=MEPH.audio.music.theory.Scales,f=g.scales;if(g.cachedBossList){return g.cachedBossList}for(var b in f){a[b]=[];for(var e=0;e<12;e++){var d=g.createScaleArray(f[b].base12,e,12);a[b].push({id:c++,name:b+" "+e,root:(12-e%12)==12?0:(12-e%12),scale:d,base12:f[b].base12,base7:f[b].base7,official:f[b].name})}}g.cachedBossList=a;return a},invertVoices:function(a){var f=[];for(var e=0;e<a.length;e++){for(var d=0;d<a[e].voice.length;d++){var c=a[e].voice.chordInversion(d);c=c.parseInt(12);var b=c.chordNormalize(12);f.push({_familyname:a[e].name,scales:[],name:a[e].name,inversion:d,voice:b,isInversion:d!=0})}}return f},complete:function(e){var f=MEPH.audio.music.theory.Scales,b=f.bossList();for(var d in b){for(var c=0;c<b[d].length;c++){for(var a=0;a<e.length;a++){if(e[a].voice.isVoiceInScale(b[d][c].scale)){e[a].scales.push(b[d][c].id)}}}}return e},scales:{majorscale:{base12:"024579B".parseAndSlice(),base7:"1 2 3 4 5 6 7",name:"Major Scale"},melodicminorscale:{base12:"023579B".parseAndSlice(),base7:"1 2 -3 4 5 6 7",name:"Melodic Minor"},harmonicminor:{base12:"023578B".parseAndSlice(),base7:"1 2 -3 4 5 -6 7",name:"Harmonic Minor"},harmonicmajor:{base12:"024578B".parseAndSlice(),base7:"1 2 3 4 5 -6 7",name:"Harmonic Major"},lois:{base12:"0236789".parseAndSlice(),base7:"1 2 -3 +4 5 -6 --7",name:"Lois"},spanishgypsy:{base12:"014579B".parseAndSlice(),base7:"1 -2 3 4 5 6 7",name:"Spanish Gypsy"},byzantine:{base12:"014578B".parseAndSlice(),base7:"1 -2 3 4 5 -6 7",name:"Byzantine"},hungarianmajor:{base12:"034679A".parseAndSlice(),base7:"1 +2 3 +4 5 6 -7",name:"Hungarian Major"},melaratrangi:{base12:"012578A".parseAndSlice(),base7:"1 -2 --3 4 5 -6 -7",name:"Mela Ratrangi"},melaganamurti:{base12:"012578B".parseAndSlice(),base7:"1 -2 --3 4 5 -6 7",name:"Mela Ganamurti"},melavanaspati:{base12:"012579A".parseAndSlice(),base7:"1 -2 --3 4 5 6 -7",name:"Mela Vanaspati"},melayagapraya:{base12:"0345789".parseAndSlice(),base7:"1 +2 3 4 5 -6 --7",name:"Mela Yagapraya"},melaragavardhani:{base12:"034578A".parseAndSlice(),base7:"1 +2 3 4 5 -6 -7",name:"Mela Ragavardhani"},melagangeyabhusani:{base12:"034578B".parseAndSlice(),base7:"1 +2 3 4 5 -6 7",name:"Mela Gangeyabhusani"},melavagedhisvari:{base12:"034579A".parseAndSlice(),base7:"1 +2 3 4 5 6 -7",name:"Mela Vagedhisvari"},melasulini:{base12:"034579B".parseAndSlice(),base7:"1 +2 3 4 5 6 7",name:"Mela Sulini"},melachalenata:{base12:"03457AB".parseAndSlice(),base7:"1 +2 3 4 5 +6 7",name:"Mela Chalenata"},melasucharitra:{base12:"0346789".parseAndSlice(),base7:"1 +2 3 +4 5 -6 --7",name:"Mela Sucharitra"},melajyotisvarupini:{base12:"034678A".parseAndSlice(),base7:"1 +2 3 +4 5 -6 -7",name:"Mela Jyotisvarupini"},meladhatuvardhani:{base12:"034678B".parseAndSlice(),base7:"1 +2 3 +4 5 -6 7",name:"Mela Dhatuvardhani"},melakanakangi:{base12:"0125789".parseAndSlice(),base7:"1 -2 --3 4 5 -6 --7",name:"Mela Kanakangi"},leadingwholetone:{base12:"02468AB".parseAndSlice(),base7:"1 2 3 +4 +5 +6 7",name:"Leading Whole Tone"},melamanavati:{base12:"0245789".parseAndSlice(),base7:"1 2 3 4 5 -6 --7",name:"Mela Manavati"},blues:{base12:"034567A".parseAndSlice(),base7:"1 -3 3 4 +4 5 -7",name:"Blues"},dimmhed7note:{base12:"023569B".parseAndSlice(),base7:"1 2 -3 4 -5 6 7",name:"Dimhed 7 Note"},majorpentatonic:{base12:"02479".parseAndSlice(),base7:"1 2 3 5 6",name:"Major Pentatonic Scale"},hemitonicpentatonic:{base12:"0459B".parseAndSlice(),base7:"1 3 4 6 7",name:"Hemitonic pentatonic scale"},donminant8note:{base12:"0134679A".parseAndSlice(),base7:"1 -2 -3 3 +4 5 6 -7",name:"Dominant 8 note scale"},diminished8note:{base12:"0235689B".parseAndSlice(),base7:"1 2 -3 4 +4 +5 6 7",name:"Diminished 8 note scale"},wholescale:{base12:"02468A".parseAndSlice(),base7:"1 2 3 +4 +5 +6",name:"Whole scale"},majorbebop:{base12:"0245789B".parseAndSlice(),base7:"1 2 3 4 5 +5 6 7",name:"Major bebop scale "},dominantbebop:{base12:"024579AB".parseAndSlice(),base7:"1 2 3 4 5 6  -7 7",name:"Dominant bebop scale "},augmented:{base12:"03478B".parseAndSlice(),base7:"1 2 3 +4 +5 +6",name:"Augmented scale "},prometheus:{base12:"02469A".parseAndSlice(),name:"Prometheus scale",base7:"1 2 3 +4 6 -7"},tritone:{base12:"01467A".parseAndSlice(),name:"Tritone scale",base7:"1 -2 3 -5 5 -7"},twosemitritone:{base12:"012678".parseAndSlice(),name:"two-semitone tritone scale ",base7:"1 -2 2 +4 5 -6"}}}});